https://www.datacamp.com/community/tutorials/pca-analysis-r

========
library(devtools)
install_github("vqv/ggbiplot")

library(ggbiplot)
===========


data("mtcars")


# Because PCA works best with numerical data, you'll exclude the two categorical variables (vs and am).


mtcars.pca <- prcomp(mtcars[,c(1:7,10,11)], center = TRUE,scale. = TRUE)
summary(mtcars.pca)
str(mtcars.pca)

ggbiplot(mtcars.pca)
ggbiplot(mtcars.pca, labels=rownames(mtcars)) # shows 2 best PCs

ggbiplot(mtcars.pca,ellipse=TRUE,choices=c(3,4)) # shows next 2 PCs


mtcars.pca$rotation #should show clearly effect of each parameter on each PC

cor(mtcars$cyl,mtcars$disp) #high correlation also shown in the biplot
[1] 0.9020329

#How to Iterpret PCA Biplots:
#https://bookdown.org/danieljcarter/socepi/pca-computation-exploration.html
===

mtcars.country <- c(rep("Japan", 3), rep("US",4), rep("Europe", 7),rep("US",3), "Europe", rep("Japan", 3), rep("US",4), rep("Europe", 3), "US", rep("Europe", 3))

ggbiplot(mtcars.pca,ellipse=TRUE,  labels=rownames(mtcars), groups=mtcars.country)

=================================
ALTERNATIVE WAY TO ANALYZE
https://cran.r-project.org/web/packages/ggfortify/vignettes/plot_pca.html

install.packages("ggfortify")
library(ggfortify)


autoplot(mtcars.pca, loadings = TRUE, loadings.colour = 'blue',
         loadings.label = TRUE, loadings.label.size = 3)

autoplot(mtcars.pca, data = mtcars, colour = 'cyl', loadings = TRUE, loadings.colour = 'blue', loadings.label = TRUE, loadings.label.size = 3) + geom_text(vjust=-1, label=rownames(mtcars)) 
====

library(ggfortify)
df <- iris[1:4]
pca_res <- prcomp(df, scale. = TRUE)

autoplot(pca_res)
autoplot(pca_res, data = iris, colour = 'Species')

autoplot(pca_res, data = iris, colour = 'Species',
         loadings = TRUE, loadings.colour = 'blue',
         loadings.label = TRUE, loadings.label.size = 3)

---
How to Iterpret PCA Biplots:

https://bookdown.org/danieljcarter/socepi/pca-computation-exploration.html